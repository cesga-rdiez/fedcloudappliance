sudo: required
services:
- docker
jobs:
  include:
  - stage: build docker images
    script:
    - export TAG=$(if [ "x$TRAVIS_TAG" != "x" ]; then echo "$TRAVIS_TAG"; else echo
      "latest"; fi)
    - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
    - docker build -t cloudkeeper cloudkeeper/core
    - docker tag cloudkeeper $DOCKER_REPO/cloudkeeper:$TAG
    - docker build -t cloudkeeper-os cloudkeeper/os
    - docker tag cloudkeeper-os $DOCKER_REPO/cloudkeeper-os:$TAG
    - docker build -t bdii cloud-info/bdii
    - docker tag bdii $DOCKER_REPO/bdii:$TAG
    - docker build -t sitebdii cloud-info/site
    - docker tag sitebdii $DOCKER_REPO/sitebdii:$TAG
    - docker build -t cloudbdii cloud-info/cloud
    - docker tag cloudbdii $DOCKER_REPO/cloudbdii:$TAG
    - docker build -t caso accounting/caso
    - docker tag caso $DOCKER_REPO/caso:$TAG
    - docker build -t ssm accounting/ssm
    - docker tag ssm $DOCKER_REPO/ssm:$TAG
    after_success:
    - docker push $DOCKER_REPO/cloudkeeper
    - docker push $DOCKER_REPO/cloudkeeper-os
    - docker push $DOCKER_REPO/bdii
    - docker push $DOCKER_REPO/sitebdii
    - docker push $DOCKER_REPO/cloudbdii
    - docker push $DOCKER_REPO/caso
    - docker push $DOCKER_REPO/ssm
env:
  global:
  - DOCKER_REPO=egifedcloud
  - secure: tqyLSU7x2rLu/iZ7eKjFcc146bMcGUpjdaROHJTVMTuMC/kCzgMZZbJ3RuT+ntI5pNmv3Ucna+f/rjuFHISh+BIzzKkNa3qXSp7AEwDWi22sKdzW0+n05gqp0L3lkmLVY4mzkvU1kTUPAnD2e2Ly2Oaj57zVu1/ZHysQ9sudrR3MaI6NCyRWgM/v+x8N3FnWShvvwPWWWnqKAr24hOoDnIyQERNiwVJGI4Cceqpx5qWYxPbhMcG2fDBL7IFJfdeU1on2InRhVW/fGaTcBkbCLzIwuBfpOe9ordegNC2gW9CULesoDWDLtn7UnIUU3Q+D4PRfob5wfFdJUGkOVOtNALU15bt74pcwppJUmOKqTM2VadlCxz7t6O+yRp5hdzT8M2fOapDqVjUA1L199PWoMfkLky/n0lxVJiG25nWV8fPQ+TDSDQziYyt5nE4pnpjHzTzWPGa92u/aFwk1/v2qDrrSCtMymFGdvXYuXwy6fTj+AqTY348GTEELlYNe4wPvstbL/pwfqWTd8urxTkX77Lc5wClDsuegLByBmG1BrPVA7H3+qcmuIkzAOo6/4jIoWjvIjEcDv0WjUGvXE3APuP2tjju0fH89x2g5DGFfpekwMO3UFlPDf7eKAv9oUa5xAnY6FDZX5wune1C79MO4RGs2vRhoochVQ7s/ejaZC/4=
  - secure: sb4fzW8R/3Z+++d2vchXEKxOO9hrU3EDZH/EaApAO69nD1sOsZ2j3q7DRWbQAKKY6Kip7f/8ZXGZPS/LODjC6A7isnaSI9Hszd96wb1wBje9ONNMPxg8VwFHndvSp9T5kG7IK+jP2Wf5Zky6JmGcTzhC8nf2bCqNeYmZtVPBYPZt9Cyw+17gqiTT4vVgBsJzj984Gmcptds3e2wkbJ0Ss0+sFz6vSS6V1/W06fXuVouQ7eRu3pWUPtbn37GgVvcNPC6OyPdayN/xwIsf1LkcJLuPChHMpsQagTkFM/Eo8tnnRTq+qewlQQTLM1IxoGVTrDVvdwOk1GuZOyz4JBENtY5WxozOxv+z/lb2CFaBJikXxVC7qVVM1K2Lzn82sHybcRatJ3xZ9rDhQ+J8WVKzV5E9SJ8/Zsz7p5RsMQUXX0gMWWWaiVNt76LVhdFRIeNcUH69oqHPn6IBnNPxEmOAylEwkIZsajEgsS4ZbxiB1g736b0cc6U83t7YZ2uP6BdmS1MLIJoI+RCI46ulcUkGtnJT6/fYKE3xNKql6Y/magN1r9wNaI7B1RvoHqFP7jflwJMsjD5TMXdZ+9gn6G/NqdhYfDgj/MamZilIP/QW2bUp8A0feF2YZrB0I+WCdh1J1f576emOEs5NQA1zaTgOXgvD3ZNlDd7NL3XjoJq4Czo=
